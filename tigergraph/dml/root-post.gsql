CREATE OR REPLACE DISTRIBUTED QUERY precompute_root_post() SYNTAX v2 {
  MinAccum<UINT> @postId;
  M(ANY) = SELECT p FROM Post:p ACCUM p.@postId += p.id;
  WHILE M.size() > 0 DO
  M = SELECT t FROM M:s -(<REPLY_OF)- Comment:t
    ACCUM t.@postId += s.@postId
    POST-ACCUM 
      INSERT INTO ROOT_POST (FROM, TO) VALUES (t.id, t.@postId);
  END;
}